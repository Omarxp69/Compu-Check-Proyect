<!DOCTYPE html>
<html lang="es">
<head>
  <link rel="stylesheet" href="../static/css/index_style.css">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Compuchek - Salas</title>
  <style>
    fieldset.form-group {
      border: 2px solid rgba(37, 99, 235, 0.2);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 24px;
      background: rgba(255,255,255,0.7);
      box-shadow: 0 4px 14px rgba(16,24,40,0.05);
    }

    fieldset.form-group legend {
      font-weight: 700;
      color: var(--accent, #2563eb);
      font-size: 20px;
      padding: 0 10px;
      margin-bottom: 10px;
    }

    label {
      display: block;
      margin-top: 10px;
      font-weight: 500;
    }

    input, select {
      width: 100%;
      padding: 8px;
      margin-top: 4px;
      border: 1px solid #ccc;
      border-radius: 6px;
    }

    button {
      background: var(--accent, #2563eb);
      color: white;
      font-weight: 600;
      padding: 12px 20px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      margin-top: 10px;
    }

    button:hover {
      background: #1e4db7;
    }
    .tablas-lado-a-lado {
      display: flex;
      gap: 20px; /* espacio entre tablas */
      flex-wrap: wrap; /* se acomodan en vertical si la pantalla es peque√±a */
    }

    .tabla-wrapper {
      flex: 1; /* ambas tablas ocupan el mismo ancho */
      min-width: 300px; /* evita que se rompan en pantallas peque√±as */
    }
    .filtro-form {
      display: flex;
      flex-wrap: wrap; /* se acomoda en vertical si la pantalla es muy peque√±a */
      gap: 10px; /* espacio entre los elementos */
      align-items: center; /* alinea verticalmente los elementos */
    }

    .filtro-form input,
    .filtro-form select {
      flex: 1; /* ocupa el m√°ximo espacio disponible */
      min-width: 120px; /* ancho m√≠nimo para no romper el dise√±o */
    }

    .filtro-form button {
      flex: none; /* no crecer√°, mantiene tama√±o de contenido */
    }
        
    
  </style>
</head>
<body>
  <div class="dashboard-container">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="profile">
        {% if user_profile_pic %}
          <img src="{{ url_for('static', filename=user_profile_pic) }}" alt="Foto de perfil" class="profile-img">
        {% else %}
          <div class="profile-img">üë§</div>
        {% endif %}
        <span>{{ user_name }}</span>
      </div>

      <h2>Compuchek</h2>
        <ul>
          <li><a href="/">üè† Inicio</a></li>
        {% if user_role == 'admin' %}
          <li><a href="/Gestionar_Usuarios">üë• Gestionar Usuarios</a></li>
          <li><a href="/Salas">üõãÔ∏è Salas</a></li>
          <li><a href="/Gestionar_Salas">üõ†Ô∏è Gestionar Salas</a></li>
          <li><a href="/Computadoras">üíªComputadoras</a></li>
          <li><a href="/Gestionar_Computadoras">üõ†Ô∏è Gestionar Computadoras</a></li>
          <li class="active"><a href="/Permisos_Usuarios">üîë Permisos Usuarios</a></li>
          <li><a href="/Gestionar_Permisos">üõ†Ô∏è Gestionar_Permisos</a></li>
          <li><a href="/reports">üìä Reportes</a></li>
        {% elif user_role == 'moderador' %}
          <li><a href="/Gestionar_Usuarios">üë• Gestionar Usuarios</a></li>
          <li><a href="/reports">üìä Reportes</a></li>
        {% elif user_role == 'user' %}
          <li><a href="/subir_reporte">üìù Subir reporte</a></li>
        {% endif %}
        <li><a href="/profile">‚úèÔ∏è Editar Perfil</a></li>
        <li><a href="/logout">üö™ Cerrar sesi√≥n</a></li>
      </ul>
    </aside>
        
      </ul>
    </aside>

    <!-- Main -->
    <main class="dashboard-main">
      <header>
        <h1>Asignar Accesos de salones</h1>
      </header>
      <section class="form-section">
        {% with messages = get_flashed_messages() %}
          {% if messages %}
            <div class="flash-messages">
              {% for message in messages %}
                <div class="flash-message">{{ message }}</div>
              {% endfor %}
            </div>
          {% endif %}
        {% endwith %}
        <form action="{{ url_for('permisos_usuarios') }}" method="POST">
          <fieldset class="form-group">
            <legend>Datos de Asignaci√≥n</legend>

            <!-- ID Usuario -->
            <label for="usuario_id">ID Usuario:</label>
            <input type="text" id="usuario_id" name="id_usuario" readonly>

            <!-- ID Sal√≥n -->
            <label for="salon_id">ID Sal√≥n:</label>
            <input type="text" id="salon_id" name="id_salon" readonly>

            <button type="submit">Asignar Sal√≥n</button>
          </fieldset>
        </form>
      
      </section>
      <div class="form-section">
        <h2>Usuarios y Salones</h2>
        <div class="tablas-lado-a-lado">
          <!-- Filtro Usuarios sobre su tabla -->
          <h2>Filtrar Usuarios</h2>
          <form class="filtro-form" method="get" action="{{ url_for('permisos_usuarios') }}">
              <input type="text" name="search_usuarios" placeholder="Buscar por ID o Email" value="{{ request.args.get('search_usuarios','') }}">
              
              <select name="filtro_columna_usuarios">
                  <option value="id" {% if request.args.get('filtro_columna_usuarios')=='id' %}selected{% endif %}>ID</option>
                  <option value="nombre" {% if request.args.get('filtro_columna_usuarios')=='nombre' %}selected{% endif %}>Nombre</option>
                  <option value="email" {% if request.args.get('filtro_columna_usuarios')=='email' %}selected{% endif %}>Email</option>
              </select>

              <select name="orden_usuarios">
                  <option value="ASC" {% if request.args.get('orden_usuarios')=='ASC' %}selected{% endif %}>Ascendente</option>
                  <option value="DESC" {% if request.args.get('orden_usuarios')=='DESC' %}selected{% endif %}>Descendente</option>
              </select>

              <button type="submit">Aplicar</button>
          </form>

          <!-- Filtro Salones sobre su tabla -->
          <h2>Filtrar Salones</h2>
          <form class="filtro-form" method="get" action="{{ url_for('permisos_usuarios') }}">
              <input type="text" name="search_salones" placeholder="Buscar por ID o Nombre del Sal√≥n" value="{{ request.args.get('search_salones','') }}">
              
              <select name="filtro_columna_salones">
                  <option value="id_salon" {% if request.args.get('filtro_columna_salones')=='id_salon' %}selected{% endif %}>ID</option>
                  <option value="nombre_salon" {% if request.args.get('filtro_columna_salones')=='nombre_salon' %}selected{% endif %}>Nombre</option>
              </select>

              <select name="orden_salones">
                  <option value="ASC" {% if request.args.get('orden_salones')=='ASC' %}selected{% endif %}>Ascendente</option>
                  <option value="DESC" {% if request.args.get('orden_salones')=='DESC' %}selected{% endif %}>Descendente</option>
              </select>

              <button type="submit">Aplicar</button>
          </form>
          <!-- Tabla Usuarios -->
          <div class="tabla-wrapper">
            <h3>Usuarios</h3>
            <table id="tabla_usuarios">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Nombre</th>
                  <th>Email</th>
                </tr>
              </thead>
              <tbody>
                {% for u in usuarios %}
                <tr data-id="{{ u[0] }}">
                  <td>{{ u[0] }}</td>
                  <td>{{ u[1] }}</td>
                  <td>{{ u[2] }}</td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>

          <!-- Tabla Salones -->
          <div class="tabla-wrapper">
            <h3>Salones</h3>
            <table id="tabla_salones">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Nombre</th>
                </tr>
              </thead>
              <tbody>
                {% for s in salones %}
                <tr data-id="{{ s[0] }}">
                  <td>{{ s[0] }}</td>
                  <td>{{ s[1] }}</td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      </div>





      
      <footer>
        &copy; 2025 Compuchek. Todos los derechos reservados.
      </footer>
    </main>
  </div>
</body>
<script>
  // Al hacer click en un usuario
  document.querySelectorAll("#tabla_usuarios tbody tr").forEach(row => {
    row.addEventListener("click", () => {
      document.getElementById("usuario_id").value = row.dataset.id;
    });
  });

  // Al hacer click en un sal√≥n
  document.querySelectorAll("#tabla_salones tbody tr").forEach(row => {
    row.addEventListener("click", () => {
      document.getElementById("salon_id").value = row.dataset.id;
    });
  });
</script>

</html>